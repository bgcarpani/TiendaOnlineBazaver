@model  Bazaver2.ViewModel.VentasViewModel

@{
    Layout = null;
}

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Bazaver Lobos</title>
    <link rel="icon" type="image/x-icon" href="~/Content/Images/bazaverfavicon.ico" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    @*<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />*@
    <!--datatable   -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous"></script>
    @*<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>*@
    <script type="text/javascript" charset="utf8" src="~/Content/js/jquery.dataTables.js"></script>


    <link href="~/Content/css/styles.css" rel="stylesheet" />
    @*<link href="~/Content/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">*@
    <!-- Custom styles for this template -->
</head>

<body id="page-top">
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color:black" id="mainNav">
        <div class="container">
            <a class="navbar-brand js-scroll-trigger" href="~/Home/Index"><img src="~/Content/assets/img/bazaverlogo.png" alt="" /></a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars ml-1"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav text-uppercase ml-auto">

                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="~/Home/Index#services">Servicios</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="~/Home/Index#portfolio">Fotografía</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="~/Home/Index#about">Productos</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="~/Home/Index#team">Nosotros</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="~/Home/Index#contact">Contacto</a></li>
                </ul>
                @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
                {
                    @Html.AntiForgeryToken()

                    if (User.IsInRole("Admin"))
                    {

                        <ul class="navbar-nav text-uppercase ml-auto">
                            <li class="nav-item"><a class="nav-link js-scroll-trigger" href="~/Ventas/Index" style="padding-top:23px">Panel</a></li>
                            <li class="nav-item"><a class="nav-link js-scroll-trigger" href="javascript:document.getElementById('logoutForm').submit()" style="padding-top:23px">Log Off</a></li>
                        </ul>

                    }
                }

            </div>
        </div>
    </nav>
    <header class="masthead" style="background-image:none">

        <div class="container; col-12" style="padding-top:20px">

            <div class="col-md-12">
                <h1 style="color:black; text-align:center">
                    Panel de Administradores
                </h1>
                <h4 style="color:black; text-align:center">
                    Acciones:
                </h4>
                <div class="row">
                    <div class="col-md-3"></div>
                    <div class="col-md-6">
                        <a class="btn btn-primary btn-sm" data-toggle="modal" href="#portfolioModal1">
                            Ver caja >>
                        </a>
                        @Html.ActionLink("+ Productos", "Index", "Productos", new { }, new { @class = "btn btn-success btn-sm" })
                        @Html.ActionLink("+ Categorías", "Index", "Categorias", new { }, new { @class = "btn btn-primary btn-sm" })
                        @Html.ActionLink("+ Colores", "Index", "Colors", new { }, new { @class = "btn btn-info btn-sm" })
                    </div>
                </div>
                <div class="col-md-3"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-1"></div>
            <div class=" col-lg-10 col-md-10" style="padding-top:20px">
                <div class="row">
                    <div class="col-5">
                        <h2 style="color:black; text-align:left">
                            Historial de Ventas
                        </h2>
                    </div>
                    <div class="col-5"></div>
                </div>
                <div>
                    <table id="ventasTable" class="table">
                        <thead>
                            <tr>
                                <th>
                                    @Html.DisplayNameFor(model => model.Fecha)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.NombreCliente)
                                </th>

                                <th>
                                    @Html.DisplayNameFor(model => model.Localidad.Name)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Direccion)
                                </th>
                                <th>
                                    Comentarios
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Telefono)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Correo)
                                </th>
                                <th>
                                    Estado del envío
                                </th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>                            
                                @foreach (var item in Model.VentasList)
                                {
                                    <tr>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Fecha)
                                        </td>
                                        <td>
                                            @item.ApellidoCliente,  @item.NombreCliente
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Localidad.Name)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Direccion)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Comentarios)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Telefono)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Correo)
                                        </td>
                                        @if (item.Estado == "Pendiente")
                                        {
                                            <td style="color:wheat">
                                                @Html.DisplayFor(modelItem => item.Estado)
                                            </td>
                                        }
                                        else if (item.Estado == "Entregado")
                                        {
                                            <td style="color:forestgreen">
                                                @Html.DisplayFor(modelItem => item.Estado)
                                            </td>
                                        }
                                        else
                                        {
                                            <td style="color:darkred">
                                                @Html.DisplayFor(modelItem => item.Estado)
                                            </td>
                                        }
                                        <td>
                                            <div class="btn-group">
                                                <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                </button>
                                                <div class="dropdown-menu">
                                                    @Html.ActionLink("Editar", "Edit", new { id = item.VentaId }, new { @class = "dropdown-item" })
                                                    @Html.ActionLink("Detalles", "Details", new { id = item.VentaId }, new { @class = "dropdown-item" })
                                                    @Html.ActionLink("Borrar", "Delete", new { id = item.VentaId }, new { @class = "dropdown-item" })
                                                </div>
                                            </div>
                                            <div class="btn-group">
                                                <button type="button" class="btn btn-primary btn-size small dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                </button>
                                                <div class="dropdown-menu">
                                                    @using (Html.BeginForm("EstadoEntregado", "Ventas", FormMethod.Post))
                                                    {
                                                        <input type="hidden" name="VentaId" id="VentaId" value="@item.VentaId" />
                                                        <input id="Entregado" type="submit" value="Entregado" class="dropdown-item" />
                                                    }
                                                    @using (Html.BeginForm("EstadoPendiente", "Ventas", FormMethod.Post))
                                                    {
                                                        <input type="hidden" name="VentaId" id="VentaId" value="@item.VentaId" />
                                                        <input id="Pendiente" type="submit" value="Pendiente" class="dropdown-item" />
                                                    }
                                                    @using (Html.BeginForm("EstadoCancelado", "Ventas", FormMethod.Post))
                                                    {
                                                        <input type="hidden" name="VentaId" id="VentaId" value="@item.VentaId" />
                                                        <input id="Cancelado" type="submit" value="Cancelado" class="dropdown-item" />
                                                    }
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            

                        </tbody>
                    </table>
                    <script type="text/javascript">
                        $(document).ready(function () {
                            $('#ventasTable').DataTable();
                        });
                    </script>
                </div>

            </div>
            <div class="col-1"></div>
        </div>
    </header>
</body>

<footer class="footer py-4">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-4 text-lg-left">Copyright © www.bazaverlobos.com.ar 2020</div>
            <div class="col-lg-4 my-3 my-lg-0">

            </div>
            <div class="col-lg-4 text-lg-right">
                <a class="btn btn-dark btn-social mx-2" href="https://www.instagram.com/bazaverlobos/"><i class="fab fa-instagram"></i></a>
                <a class="mr-3" href="https://www.instagram.com/bazaverlobos/">@@BazaverLobos</a>
                @*<a class="mr-3" href="#!">Privacy Policy</a>
                    <a href="#!">Terms of Use</a>*@
            </div>
        </div>
    </div>
</footer>

<div class="modal fade" id="portfolioModal1" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Caja</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="container">
                <div class="modal-body">
                    <div>
                        <div>
                            <h5>Caja Diaria:</h5>
                            <table class="table">
                                <tr>
                                    <th>
                                        Fecha
                                    </th>
                                    <th>
                                        Recaudado
                                    </th>
                                </tr>
                                @foreach (var item in Model.cajaDiarias)
                                {
                                    <tr>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Fecha)
                                        </td>
                                        <td>
                                            $@Html.DisplayFor(modelItem => item.Recaudado)
                                        </td>
                                    </tr>
                                }

                            </table>
                        </div>

                        <div style="padding-top:20px">
                            <h5>Caja Mensual:</h5>
                            <table class="table">
                                <tr>
                                    <th>
                                        Mes
                                    </th>
                                    <th>
                                        Recaudado
                                    </th>
                                </tr>
                                @foreach (var item in Model.cajaMensuals)
                                {
                                    <tr>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Mes)/@Html.DisplayFor(modelItem => item.Año)
                                        </td>
                                        <td>
                                            $@Html.DisplayFor(modelItem => item.Recaudado)
                                        </td>
                                    </tr>
                                }

                            </table>
                        </div>
                        <div style="padding-top:20px">
                            <h5>Caja Total:</h5>
                            <table class="table">
                                <tr>

                                    <th>
                                        Recaudado
                                    </th>
                                </tr>
                                @foreach (var item in Model.cajaTotals)
                                {
                                    <tr>

                                        <td>
                                            $@Html.DisplayFor(modelItem => item.Recaudado)
                                        </td>
                                    </tr>
                                }

                            </table>
                        </div>
                    </div>


                </div>


            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>


<script src="~/Content/js/scripts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
